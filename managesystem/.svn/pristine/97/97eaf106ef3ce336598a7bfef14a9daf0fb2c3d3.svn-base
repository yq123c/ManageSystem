<?xml version="1.0" encoding="UTF-8"?> 
	<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" 
		"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="com.five.managesystem.organization.dao.OrganizationDao">
<!--  根据id获取此id的下级机构信息 -->
<!-- public List<Map<String,Object>> getUnitInfoById(String id) -->
<select id="getUnitInfoById" resultType="map" parameterType="String">
select t.id,
       t.parent_id,
       t.parent_ids,
       t.name,
       t.sort,
       t.area_id,
       t.grouping_id,
       t.type,
       t.grade,
       t.address,
       t.post_code,
       t.phone,
       (select count(o.id) from sys_organization o where o.parent_id=t.id)isParent   
  from sys_organization t
 where t.parent_id = #{id,jdbcType=VARCHAR}
</select>
<select id="getNameById" resultType="String" parameterType="String">
	SELECT 
		NAME 
	FROM 
		SYS_ORGANIZATION
	WHERE   
		ID=#{id,jdbcType=VARCHAR}
</select>
<!--根据机构的id删除该机构  -->
<!-- public Integer deleteUnitById(String id) -->
<delete id="deleteUnitById" parameterType="String">
delete from 
	sys_organization t 
where 
	t.id=#{id,jdbcType=VARCHAR}
</delete>
<!-- 添加一个新的机构 -->
<!-- public Integer addUnit(@Param("dutyInfo") Map<String,String> dutyInfo) -->
<insert id="addUnit" parameterType="map">
	insert into
		sys_organization t(
			t.id,
			t.parent_id,
			t.parent_ids,
			t.name,
			t.sort,
			t.area_id,
			t.code,
			t.type,
			t.address,
			t.post_code,
			t.phone,
			t.create_person,
			t.create_time,
			t.modify_person,
			t.modify_time
		)values(
			#{dutyInfo.id,jdbcType=VARCHAR},
			#{dutyInfo.parent_id,jdbcType=VARCHAR},
			#{dutyInfo.parent_ids,jdbcType=VARCHAR},
			#{dutyInfo.name,jdbcType=VARCHAR},
			#{dutyInfo.sort,jdbcType=VARCHAR},
			#{dutyInfo.area_id,jdbcType=VARCHAR},
			#{dutyInfo.code,jdbcType=VARCHAR},
			#{dutyInfo.type,jdbcType=VARCHAR},
			#{dutyInfo.address,jdbcType=VARCHAR},
			#{dutyInfo.post_code,jdbcType=VARCHAR},
			#{dutyInfo.phone,jdbcType=VARCHAR},
			#{dutyInfo.create_person,jdbcType=VARCHAR},
			sysdate,
			#{dutyInfo.modify_person,jdbcType=VARCHAR},
			sysdate
	)
</insert>
</mapper>