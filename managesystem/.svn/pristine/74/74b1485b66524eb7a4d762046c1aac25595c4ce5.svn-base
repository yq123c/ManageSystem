$(document).ready(function(){
	$('#validateBtn').click(function() {
		$('#loginForm').bootstrapValidator('validate');
	});
	
	
	$("#loginForm").bootstrapValidator({
		message : 'This value is not valid',
		feedbackIcons : {
			valid : 'glyphicon glyphicon-ok',
			invalid : 'glyphicon glyphicon-remove',
			validating : 'glyphicon glyphicon-refresh'
		},
		fields : {
			username : {
				group : '.username-div',
				validators : {
					notEmpty : {
						message : '请输入用户名'
					},
					stringLength : {
						min : 2,
						max : 20,
						message : '请输入2-20长度的用户名'
					}
				}
			},
			password : {
				group : '.password-div',
				validators : {
					notEmpty : {
						message : '请输入用密码'
					},
					stringLength : {
						min : 2,
						max : 20,
						message : '请输入2-20长度的密码'
					}
				}
			}
		}
	}).on('success.form.bv', function(e) {
		e.preventDefault();
		var $form = $(e.target);
		var bv = $form.data('bootstrapValidator');
		$.post($form.attr('action'), $form.serialize(), function(result) {
			console.log(result);
			switch (result.state) {
			case 0:
				location.href = "index.jsp";
				break;
			case 1://锁定用户错误
			case 2://账号错误
				layer.tips(result.messages, '#username', {
					tips : [ 2, '#CC3299' ],
					time : 2000
				});
				break;
			case 3://密码错误
				layer.tips(result.messages, '#password', {
					tips : [ 2, '#CC3299' ],
					time : 2000
				});
				break;
			case 4://其它错误
			case 5://效验错误
				layer.msg(result.messages.replace("~", "<br/>"));
				break;
			}
		}, 'json');
	});
});
